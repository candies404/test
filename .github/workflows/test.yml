name: Process External Settings

on:
  workflow_dispatch:  # 手动触发

jobs:
  process-external-settings:
    runs-on: ubuntu-latest

    steps:
      - name: 克隆第三方仓库
        run: |
          git clone https://github.com/vastsa/FileCodeBox.git external-repo
          cd external-repo
          echo "仓库已克隆到路径: $PWD"

      - name: 替换 admin_token
        env:
          NEW_TOKEN: ${{ vars.FileCodeBox_PassWord }}  # 从 Secrets 读取值
        run: |
          cd external-repo/core
          sed -i "s#\"admin_token\": \"FileCodeBox2023\"#\"admin_token\": \"$NEW_TOKEN\"#" settings.py
          echo "修改后的 settings.py 内容："
          cat settings.py

